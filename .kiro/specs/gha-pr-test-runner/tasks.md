# Implementation Plan

- [ ] 1. ubuntu-slim ランナー上での共通セットアップを確立する
  - slim 環境で docker/compose と Playwright が動作するよう、必要な追加パッケージを明示インストールし、セットアップ手順をジョブ共通で適用する。
  - Node 18 / Python 3.11 のインストールと npm/pip キャッシュを有効化し、1 vCPU 前提でタイムアウトと並列度を適切に設定する。
  - ジョブ間で共通環境変数（CI フラグ、BASE_URL など）を整備し、失敗時にステータスを確実に反映する。
  - _Requirements: 1, 2_

- [ ] 2. バックエンド Pytest ジョブを PR トリガーで実行する
  - PR の open/reopen/synchronize で Pytest を自動実行し、依存インストール失敗・テスト失敗時にジョブを明確に失敗させる。
  - pip キャッシュを利用しつつ、テスト結果を収集できる形（将来の junit 化も考慮）で完走させる。
  - ジョブ名を必須チェックに使用できるよう安定化し、default ブランチでのブロックを想定した結果を返す。
  - _Requirements: 1, 2_

- [ ] 3. フロントエンド Jest ジョブを PR トリガーで実行する
  - PR イベントで npm ci の後に Jest/Testing Library を CI モードで実行し、1 vCPU 向けにシリアル実行や適切な並列度を設定する。
  - npm キャッシュを活用し、失敗時にジョブを確実に失敗としつつ必要に応じてレポートを残せるようにする。
  - バックエンドジョブと並列でも競合しないよう環境変数やポートの衝突を避ける。
  - _Requirements: 1, 2_

- [ ] 4. Playwright E2E ジョブを slim 上で安定実行する
  - slim に不足する Playwright 依存を追加し、docker-compose ベースで frontend/backend を起動してヘルスチェック完了まで待機する。
  - `npm run test:e2e` を実行し、失敗時にコンテナログ・レポートをアーティファクト化して原因を特定可能にする。
  - E2E ジョブのタイムアウトと再試行方針を定め、他ジョブと同等に必須チェックへ反映できるようジョブ名を固定する。
  - _Requirements: 1, 2_

- [ ] 5. act でローカル再現可能な設定を提供する
  - `act pull_request` で各ジョブが slim イメージ上で実行されるよう、act 設定ファイルを用意しデフォルトイメージを slim 相当に固定する。
  - シークレットや環境変数のプレースホルダー（example ファイル）を整備し、クラウド依存箇所に代替値やスキップ条件を明示する。
  - act 実行例（特定ジョブのみ・全ジョブ）を想定し、ローカルでもステータスを再現できるようにする。
  - _Requirements: 3_

- [ ] 6. 必須チェックとトリガー条件を統合し、品質ゲートを担保する
  - pull_request（main/develop 想定）および必要に応じた push で 3 ジョブが起動するようイベントを整理する。
  - default ブランチ向け PR で必須チェックに使う安定したジョブ名を定義し、失敗時にマージをブロックする挙動を確認できるよう設計する。
  - 成果物（レポート/ログ）の収集と fail-fast オフ設定を見直し、並列ジョブでの失敗原因を追跡しやすくする。
  - _Requirements: 1, 2_
